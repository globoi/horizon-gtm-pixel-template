___INFO___

{
  "displayName": "GPixel",
  "categories": [
    "ADVERTISING",
    "ANALYTICS"
  ],
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "brand": {
    "id": "brand_dummy",
    "displayName": "Globo Comunicações e Participações S.A",
    "thumbnail": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEjCAMAAAC/9cySAAADAFBMVEVHcEwgjc0nUPgvOfwAruQSR/8RP/8AhP0AYf8bjOwbdPMCh/wBkfoArewApvMAu8swa+QBdv4Cf/0CmvYDpPACbf4CZP4CruoLxJYgMP8DR/8CW/8CtOICUv8BuNkBSP8BvM8ULP8Cv8VGymABPv8Bw7MCxaQAM/8CwrsNxoMBxbACxqUByJgGKv8BofwCyHoBsfoayV0ByYkZJf8AyXUbyk4tJP8AyGTTzykcyVRYLPlCJf/miUIrXfEnQ/kIyFVUJv8pmNshrM0ltLEzeOOJJPFoJv8jvJJHR/BmQelSZNoWyUpEg9F8Jv0/nb4tv3lArZ9xU9RZg75LtYOQI/VxbL79RkCHPN5bmqNKvWnDMrR0haMqzET6M2OKV75lqIWkIOmcQseTa6JluWF9n3pBzj+5HNqOh4lJzUCrTK5b0jqDz0HEIMmJ0kO1V5epdYKAtVX5InaVnmWUzz7NGMmtjGSer0nEXn/FcWmQ1i7fFbf3G4q5oEP+OErJhk/uyxy61TSy1SLuE6b+PVDvxhvNkz71jxjC0zfw1yD/Gnr/hBD/IG941TT4E5T+F4OS1kWs2EL/FIb/F37/Gnf/J1L00Rv/HXj/IW//Jmj/K1T/Llr/Nkj/NVT/ZR3+Vij8wwj+ogTt3if13B6j1yn/KmH/MFv/NFX5UkP/PUn4ZjP4eSLzjxjvow/ouQrgwQ7UyhLHzxf/FnT/N07zsQX/lgT/nQP/pAK/1yH/GWf/QUH/hgr/jgf/TzT/Vy3/qgH/ZCH/fgzQ2R7/HF7/bxP1wQPizw7d2Bqd2Ez/Rzr/rwHxzAn/IFb/dg//tAG620Ow2kb/uAHD3EDs1hPM3Tz/vgP/JE7W3jj/NkLl4Sz+wwf/yQnf3zbq3yj+zgv61BDs4Cby4CX32hjf3zP/XBr/ZhXx4CD+1wz/PTz/USH03yP/1Af+0A7/Ui3/TiT/fQ3/cRL/qgP/twL/rQL/nAT/KUb/LDr/NTCR1lCn2Un/Qyj44hvq3zP44Svx4C7+2wz84BOBb+ptAAAA9HRSTlMACCZCWGeIr8///v//3MCLFf////////85q+f////////V/yf/4bP//1///////9r/lv/+/3f//xC4zv8G//////////+l/////////////////////xD9//55//8i/////////////9v//rTNSv///0r/i/////39//+j/zT/G8b+/mAoyG2hTsFLc///3N1o///uijb////x4MqvoYZyj5Ox////////////////////////////////////////////////////////////////////////////b////+T/zf///+zx/83/2ejK4MOw5c3uVCDkeAAALA1JREFUeAHs0EUBwDAMAMAyM/mXujSvORiehCN3QRkXUmltrPMgWGtj0joLzgr5nZ+gybhaW22t+YZbWwcDzrJglJBf4fA0Z50VNYBXHq/QADF9PYwyqc3a5lYP8swzuXUYiMETd6d3997tSKn3P9tbkMyGmB3O+00Z8gm+AbCQDGspLSchBVai3nNPgPXPlVetORiORiNlRc7SFIKWZ9XrjXtj8DrH9A0F1C+sV2FFzgKup+unLmg59aCx6Oa2cX9eqJqdyWQ0ASrjLAqhGgtPbwxa0+n05ozsVQMqaBRovXhcxlmBFjlrOp5CZ4Kr1hrOZjPHytMSeVSQojLOAiulNZ/OzwDXfXMBVDN1FmDZaximA3ARLWjqYc0FV7W3QrMzgwCLWIGWcVaIoVMwljrLaXm3qi6r+mC2nnmF0qIcvsBZZpTCWT38lJYTWM2Xm0ZFs3jfGq7XoAVUM0WV2lmaQnWWGkudJdr2K2mrznoNWNZZkHUWNzycNe7FBQ9jQZu7iyraaqe0qLTMznrUFKb6Hc4KtPbLfdXMVRsAlbICLJ0ONB6imaW44tcdpgXt9/vNoUrmai48qshakN/wVPDeWYTqiVj5FGoM915395UZDK3hbqchBCvKoZvwlEOnCBc3vFMwVsB1PG4rMiLuBzthBVicQ+MsETuLUD2PQ2dxZUFHobXpV6OudmtDa8LnMN1ZEK1SD0udFWiJNocKsFrsgGpHrESJznrwzrIhfFZWovgWApX8RNnXfB2sPC0teDMeAi4apenOYmOps07H091F/qwYFxU8aNGLNBRY0TWE0s6CTiLQyp/VmoNonEXXML2zILOyQghPgusNtPJlVcijvPgeOpnvyolr6LylrHhlKat8aYFVUVAKecSTtdLXkI/hdKyVRc4CK8DKlVZtUezUWZDNIVjZocWdVVpn0crSyvKw3g557isBVSitdXwQ4xzqyyF/dQjOKtlZ5hgGZ53kASvgOuS42wtFVeyIlzqLU5hwFqzljcXHENov1VghhqIMt3wLqAIuZmVLi3JIzhIlYxhYBVwelaP1ntt7YrOANIeKi2PIrKyzSqCS30ePWVEKtbGAyml7n90hhAKrIqCyuCwt/sMCuD6egSvQos+kfyOLaX1mVVhgZZ214xzy/6zsLKjUek84S990fLsHfclzyOkDFkhZXNxaioudxTurRAils4CLaIEVOUt9BVjv/XxC+F0wLZCyB5Hfd7AdqN9LZ61EZyUb6wvP19f2Ip81Gmvnn1THawzVWaHfteE/QOuDBvySaOlqiGgd8gnhd+ysIsohj/jow4NdDqWzVtpZiuoY+QqgnPIIIkL4rbgCqhjXjjqeziEveLAKpdX7YFj/M1YuQbxfABQr3lpB8dJKOOsarMRYH0hhghWthq/IWT9ZBLEJVN94zEkMUlpDp86v2p026bZ9+6sbr+kNWDGt05EO4Z8yGPK1hWCy1hJSw3/M2weTqzYUBeAFDLMmkzHbkcs4bO+44orLJv//N+UeIa7ZLnhN5w4k09/75kjPtGYURUIIz/Nc13UQmxLIWB9nT56DLBe2HVJqlAblmnJF4UWIWnGvRqPB2Hgsj6wwqltDEoIPcADDG4mF/8OBU8WA8SIM7+7uIBfHTCW1zN/jneaQnSJBRHYAll8cCS/d+rHUwoxGfcOxBKyyw7Orl6a6WnAXQ4qrZXixVLXcvT+UMCYoxPRqiYyKIv7cz5y7karWyOhq2dEQgZfzBy8h4hFierW8YZ4oqPb3DGx8SEdpuDXHrtjOPmPFFyYXK1FYotInKvTd0+GhuqX8/PyMT8GCSuuQMzb4x3sih+JV+EJsv3jz7xlcAGuUfyE5HHHiwFArSyippDSW5Xh+4dpQNUum18OXTZWwJjR3hmI5SSKbBTC37Ccq+aU0X0g/Z1w90iKuUu26iJWVwVu8Bys6AOaW++6itbM6fGuFnDXsklgTzGRi6hYfRAkylIdTolaCb9IwFmsBS+bvWok/SZxZyXaNjV2FzKWP5ezzvdIDyptmKSvcUtZ/5WNaaNZkZhm6Cndc2qvGbXY6b5qltHgZZiGtQPtXqWTKvIxch8E82SWyS1gxlv/+X8Nciqz0tawZlPLjzsRVuEgwZbBg1ZXPLLhZft4s3FTmZrGWpYsFJQTr0EAsdwErDLACPWBYcbN8qhY3i61UshvwmlozlpoYuQ6Xgq3opIVl2ZF6bMHNOvQPfX6x++06xP33mlaz+pNiQgOvCxcyiSzYXAcrEJfKClj+KZqFYtX/qquv50DFxZJYei9fvcYaG7hlIYpLD8vLH4ilrVaKZhEWNYu4yKoOK9J6LhaLch2UxppZBm5ZBa65pbNhXXZX3VVnRdVK82b5KBZN/hErL0JgySdgDW2sNU5GblpiUYz4HssSl5erbpeoUqrWadoiKx/F8omqfoTJHt0Da2d1exVqYa1pcMKExv3KWmxoVHSa5awuV6hWZ0VWaXrqp1Kr7mfNAhWll30soBahfH2toYO15qHcGYZlbzbAkqPVrEAQ1ooW4SoF1im4KIfQohzVjzH8yh8e28NK72O58XoNp/zUN21/h9UOTGgUa7iSXK1ViqBZCKykFqS2vS2ouFfZ8/rG982CEVdrPVsatr9vkEV++h5LrFRSVOuUuDKtOibL8Rbvvyusl39egPXv/cPj1YVes2TwH9Nul3qbQhbfY9nRKsmooJVT/UejpLag2p7RtF/a/1NnN7tpK3EUwEXQXWSXXZLdvRcpEiJSFdQsIISCjbFxwZ9xbYfWQPr+79BzZsZl1M2Y3fScf73q6qfDh4gDK7y5u7QajR6HXbD0VyJ0bYq3WOtcnnGJc21ZKqtXal2vVqDiLWnl0ErsyuGL0B2N/MeHXjeslsyyj8PeFFisimlZs/v5CzoPaNVOi1TUul4R6voW48KusCxggYq7otXI9wddsdR719Cybw5rUqmal3Xzn5AK8HgN1K5QanFZS5Zxlo7K/2erR3/YFUtxPVuHhSx4rAmrH7yg8yAIqIWuhJbIkhW5VVj/gkosa+QSazx+6oyFWId1tVnrMS1r9g+sUHIJq5AFlK6lDcuFFkIr3x/7/kPPhPUVPefJLiwNig/P+OFJKhUhhVlJru1qu9z+aeWK+K4vtPCnUzMWailWf727aFn3CyDhH/MqvRBptaQWvSLUcSJhpQ8r9j8NDFjKquWa2IW1W8uqeMYPz0VrFQYhj7MKQ8wKWbIR66DarmTGcXxnxtK5rPqRZtbf7UglijNh3UwXGybggQtFQIVTXtFWWEWRi+pasR9/jocmLEZx2YaFZVGJkVpGrM0CDVA4bcI22y2OEVSMI6kSN/HbxIgZi1Itl4XLUk6IcVlX002bEAcwaRW2VqyMiyYCi+WuMCwzFtNyWbgsPR2WtT5roam0ynhslCmrJEoSSCWUQnJYIWYsXcu+Zb2hXbFmwNptmJRNYUWtIszCDFS8iCUVSyserS7CApSNy4KVXsOyvk03JSuosCtiFcQqtkWGREKrQhMVQCUxrPJY5M6MpXNNZnZhIWcrE1bPK3fCimVgBawMXIzgqipqVUmVMDlnlbdW9aAzFmPZ96yrNz0GLMQrZdIyZQpWcmVMJagqjSoXidm6jicXYH1Bn/5qrHdFRSulhW3Bilx7YKEiCY9WSUvFTnomrO/oOXZh/Sgvw+r/XlZTNmmTFiqQKvYZWrXJqzw/5Cp1Xtewqo2/OtCKp7b1bBVWr3w7ojjRo2fEPZZMc4IU2jRFAypI0Wq/r1BIHdgDlnVQVqRChmYsncs2LE8i8cGnZ/z/5ak8nU4cFlOwUgsB19kqR2F1qGmlMjBiKS3FBVyLMvOOesxY77DCNaxM8VF87D+oxUDrsAeVCMF+5vkv5ulgN3UjisP48e0LsMyeJ8giEkiWusorRMJy2gabAMbBY4gdbkJp23vz3v1OPJlANx7v5vsfss9P42xmm0b9WGS96EqCaiCWfHuwWSqk+KmWBlSuWPknV4bW7PdZxmaL2Y34vCx+1isdS1AlF1aPvVh3t9aKQcWA4thSB1aOFddZZXpqlXF9/3sMllJZr19XIwmqX/54ZBzjbvt1H7T1w/o3plbahZUeYLlSMVWiWTHbxB4vi9zL4rMNqntlcnssY+lpVKqUWq3X8zn30ZJhlS+5jopflkN11pN4vSyyZNcSVqPy8bzbWPpKkNLgworrrGxYcVqml+lpRVZsIvF7We5t3UhYxbcXWGU/VlSubXNuO6cKLea0NKOXGcZ5PSy6TtNF+tWVBFZyiRVJb3VHtV1vt3NWzVm1rD6pdhzLjdFDy2SsyPaxB9Yi1dnXtRpLYNUO6pn5YI2SzooRWrTs1ix3S6R2/MwuVy2CqzDG5z8HS630tGkkgfWtVCV7z+Wd9HdfwuSk9GmRSmHVoNVxGbMzZ/ER+r8sjq4ltOISJsflhRXVHRVVnK2p0PrgIrNr+eO4CuPzEUp8vaCU+wjf0EqezypH4lPSUb1sX6qKo4aDqsHKcaGkP20zEZ+mC7KvK+XDDa5a35TrXnyKE6CY3gtcB31XnKZWbbe2NbrvZuP3f8eK5bimkQTXqHRSr8+lH5bcJepEUB0qZqWgalqGFBmOqdUQrFQvTW8kwN4+pXSeWDFaNqQOh0ZHSnXcsdb1vfW1knjlXhZ3JQGWqJK91z/Fr3iSdFQHDi+1OjXN8WPtkbfl2vwlnk3AclzTiQTYfWmptFq8q9UKKjrxtk4ntI46anVd+4kMwSoWthsJsrfXr+ohym8WC63TAavT8XSk5kzr76dYvBuvii+ssQRZfYaVyIAmdSelI8dl++fY7vkEB2GhxWgaSZCNylftX10ig7r7YbU0pJit5fY/ZVBjaxXuV0iJsxqKFcnkx7ul+h/X+/5nLMN6KqjzWo0l0P5jhg52EgaCMI5P38J7n8CDyR7mOXrrnbDpoeGEm6allIXa0mJBFRVQeVFnKBtVTzRR9vdtNnP+R1SJUxEFJ3MiPfmZajKdCThZ0LbiWJdgLcWx2HXudagF6N9oPTH0LBPQxVWfcazeBVgr5FYtH7pxHEQRx0Ig39AFyr6pJRGs5ajUKOBc0O2XJlYAFgtTNqelEZyJkKWpJR2wmKfaVrQqRDgHl1qZWgFYLUznVIrQr8aR7/1nMRRuMKjL0tSSDljNUdwqpR1UuVJFEYaRT9nwjwqJOAuCxWAgZc2lWBsrAMuFx0zGLWuWyyrPc7VaFcWY0kU+xfM8JKeFQRTUJs6yO8qzoEBTmSR1PTTKoWlFkwi2U19CUSrWNM09eSCPZL1+Is/khWw22wO91b/s9K71+jZl7wkbJaNP+9Zw/z0X6blgPb86duLxa8gx1Qd1doHsuBGEcdw5VfAqe4NwCsLMzMxmZkbZsmPOYz7Mft+o1aUpvwtMj3YP8Kt/j55tWiUSyWQylUqlM2mZLCeXzXHyZgpmioUip4Qpm/+CqZh55x08sLK0rLReijkwn0Wr+ja0qv4YtcJk0ikjxYMRK6NVEK4i/pUKwsUDqdAKj869beG3DQcGd7xU9e03h10JVjojYYlVDmUJFbVk0FWhJHEFWDYXweI8US5p65mYE/PCl9KVWDGrqmJJV+CqiZaGJVwFHk4dJ9jE4qGWWHGUS8qiF35gdGM+Y1a6g5DSu126qmUwIVVabiwtq5FvFpqFFqjq9WIdVnZa4JJp46iWndZXDtzu4d/x2hUGVKarDqw0rBru964dFiffy/fzzXyz2WxBi1zFAq3u42rztN9pW20JF5bQmXnjy4AKD6yESqw0LFgN0tlh9FXYg1W/0aBVq1Uf1TlFKy17E6mlXIaKB/NSzKF54TsJC1bE6lhLWKtlJKzBEFrj7Dg3htUk18v3+vkGtIA1ao2oZXNRS8ZTLeXStPAmdGge+T7cwW9/rAKLVlNZwkhYxspg5Wa0wiAsKWtU5+Gt5YdX/LxUnuMsyh5OxRMt4ZJN/C/+ijMXll5bZgd/pJVZwo4uIbrCdNPLQXqYHg5RFsKaIazJJB9ZQ4Q1WqErv+4XwbXGmZfmfOBluCoenohW2NZXz8QcmweffEssbqH80TBNbGQJSdVdIiyWNUZYLGtryoIVRqzqq/rOaPkmrnVJqIzWglzU8kRr/058H+d8HXNtnnrjS2PFsDooS5ZQw+ouocWujNVsxjuLWHZZqwCriLP2obUmFwZYPB5HuRjX//G4/oXl1iWPJYz8NRqGRSos4RJdccawgha3UMoilpS1qh8dAQvDPQRWaMXjGa2Kau3NnxAfPRZzcd77TspCWNzC5EbCkq4GWhaurC20aGWXtdvt6tTirEv+es4jXEhrIXHB69jEtXfUCvMZtAIqbCGs9MYilrHilcUtxJVllSVWuLN2SOvID7QwikWtBeKKbOIx2nr7LUetqGX97a5YsCIWl5BaKIt/ORyUtaKWYq0ZF7TwnOAseDjS1inTctYK89Rn34U31tQOK7yyslLWdsuwtCx9HaKs+pnvn2lZ1DoJtUiFI3GdipXDbZmwpkFY57SSLcRIWDOExSuLZdlYK15ZmMBKvU7WJ9A6OVmol3fhnXquW/GWR1lcQgnrUsOCFbTkZShlhVgtWUNocQvPcEIpWlEKXAtwcbwrj/OR41aYF34l1kbC0i3UsDAIS8o6XEPe8NS6plbE64QTcF0xrgvvn8di7s8bnwTX+3m0LA2LVPoytMtiWrTygzW88dc3IiVWokWuW+8Of4u6P089+P3g7wZq0SrU2tprqHvIshjW2TWsHrZ3Rk1NZeka3vNb5k/kYv2OfZdfMNUXKS+pVKzKrhCSOjZzSByBACRlo3Xuhjoz054BPd1Mddvt6Z5WRRECBAU0oBBAHVv19PnetRbf2h/Z2aFP64Uk71pwSelTz/fulewk0Watfr/GtAjVnfVv1onVV428d0bil0YxhATrwewDwGozC6zcox0eQwvrHjqLaC1rtYjWmoW1cWf9DsH6ZulR2TszUdkxK5aYwseAtanNkmMoG55oobMefk+0VsksuLVGawO81iFXNeOdpaQrrrFkZW0uCFj/6TqLYZFYD0ELZgGWxUW0iNf6egN1dabiF8d0ZT0Qx/fH9mLYbpaARaHSogVYGpdVa2Przlat7J25qHTFTiHD0qhYLGdWRGc9pCz/Y3V5dXV1jVhR7qxtbBCtRj3hncEokkuwonBlgRZYxZtl5nAVqAytbWh1RpMsPXGwnt7QEZVFiTTrnjbr4fIy1CKzEGLVzCvvzEapVOWJM4svhnGdpS+GwAWzSCyCtbOqWe3WM97ZTiI7Dlamsh4TrBizvms3i44ORAvZnQKqsx6VrQDWU5glL4ZsFoXH0JqlCx5jiABV4PVGEoWJZ3zK6t5ZDItiUDVhVc9EpSefz2MKIVa8WQwLuL4nWtu1fMLrsfiklzVL9Ls0C6y4syjbzalAeT0X5alkdmJv87RjSNmuTZUTXs9GZQqT+3v/E3c1tAX/j90WSPV6/ADA9jqbdXBwOB0G1SeWLuSmW8Ts6OjIwjo6Ojg8bE1P5cuZPqj2KOVngnLBplwOMgnldXpjQT99Lm3pp59++umnn3766aeffvrpp59+VDqdVH0Mp0qyMnJprJL1P94T0C6JT5yVX/lSZ7yY9D5G8q3dg13OJ/7itdSfiNTXWGOltPfBE+zee6iD+6y0qp80rKJhhRCuDz6MOb5zSLAou5/0JJaI1SUCdfnW5Vu3blU+9CxO3QOt5YcMK/Opw9K5pVNSHxwWv45m+QzAwhBe/voW0fri1uJo6iPAOjtmhbxavLW4WPrQsB6C1hmCBa3QWMRqsaI+glnc8GcElvaKMu5/WFiC1dmApbP4UWBxaaHhP3VYAtWLFx8e1pkyi4cQiYXV7yy+EAJV36x4WOQVD2GXMewfSg0q2mAVD6t/KOV2J1ofBZajdRZgLTKqj2UWi7V2JsYQM4i8/HiddRbGUIj18mOadRbGkFkB1sc1a+1Th7V4y6HqAqt/ztJa0f6IsBCM4dmAxaj6ZnWBJaawx66Gyk+nUtlsNnW6+8wloKL98tRm+cl0oZDL5QqFIKN+3dVQFrzKlPP5ej3/W96JQV9+ga8uoF+/Tyjv18VPFYcujPy7+UaFC0PFlO9x0qlsijDqnRRmOa9evoqH5RdyE/t79KEq+i1Oe3v704VAnbKzpFmJ8lRtd3uDsrXVaNSqeQZ/elCfDdOXX/zL5vPP/3Dus9+rUzuVGrjgPkcaH2L755GhYpI/aw13CE1ujaUcLIcq1iyQmty3b2C1n+eA7LVywameKV0NwcrUm9vghE2Lst6o5hO/itS5z7+l/OtbkGJifxjOnE6qIUsKrICKFuWCwZXSrGiD1ddfMxOCtQhYXc1KZPdvbG4ubBpWDOvvlL3psoqHJR8bZqZ26T34NpYVZal2alyJ4fPfvgYrR4t5nft9d6uAimExK2Qopcyd59AtwtH0MSzh1atOsFQBqChCLH7v3NF0EHN3Rz42VPnm2gaWQYUFWlsGlzodqtffYv3/cPkDI5KV5qVxffnnL0dKvrhNT2pJWNxYncxKTzx+/DjMCp+a5WgRr6NcItYs7qzE1PYaAlqIZXVnHVlqVLuP0WeDr3VicA3HMLdaCa+ACtG4Bvxi2CtpltEqBpbKPbOs5BQ6VnhfZivoAItZAVa5FoFqY31j3ai1hE/U6qLVPymv/xlDi9Lx25hV9sIf/41hYSEhVoRpoASvbGNJWDrHrKJg+aQVsQqbJWBpVkTrqNDRrOObO/S+8rVVQwsLrAyvddoI4Yr/rLbMIFhRWC6OlOuzaFZFicqAos2okBGIxawELMLErF49b4OVfB7DimgRKvuO36Oc6mAWdxYeTZ9UC2LxHIJWzMdqBed//PFHzYppMSvaYhSjWSGOlvAKtGiBFHvVBusFw4owKwAr0GqDJcxCrh9NqY5juGpxwSxC5RoeuGzDm0FcadQ7sSqDFYXtitNrOM4reWrAZlSIeFGDgyXEEmaxV4xKXAv/m1GZKfwrAlpxZoGWNAtiGVqQi8yi3M938uq2RmVhvWZaWCFgWFG0stIreW7gMRSFBVphWK6w2s3KEKuncgqFWUzLfljIUS4C1rLAJUqL53D9jjVL02pEtnzm/G2KcUvwEnrxULb1Vgrdji27XTaW84rvezlYYgjZLO72p2FWmzyEYBU2iz8a8aAgYYkD/PerAlWYlZtDZOVRpp1VYhCosAgVViwt4JK0kkNSLINKeMVmhYZQwGJWEbAmQQphVrKy7MHhLyFah0EELIvLjGFExYeO8RZXta3kf1e/jWhYPIzcXZHEXotvWxloL6woVMyqEyxmJWGln1mxdBYQKRabBVRgRZlWEhaz0nIxKjYLm7SiwsIPUH0Dt9pqK3/77t3bd2/f/pvABVQClwR2Tn5LDnBZVrSZ1UVJS6PC0qgELMFKwPKfg5SZQoglGovNYrEMq++u56PNYlY8iM6sO2wWTyIPIhfWXYqQi3HJswQ2dz4Poj8kZ9BmZKikn4wpDY1wYdFmsSQsy8rg+lnAyj5ta/cFQrW3P5GjTLf2wEpUFmB9d5jp1FlCre1adapen6rWGpoUTlpb3PCUuoRVB6sIXOcHhynnBj+XdmFTeBBVKoLVxQtFftJPJYtDPITc7qD1QsACKI1Kwko+d+2OGFZ7ubTPH97TOkJlWVj8cX9T7WNop3CNWTXrgbK9HdSbkAu8Qq210hDlFzwyqLAdrfPDgbKNlhkeJLmwXMBrWIjFqPAzUkye/EhWwGJUYNURFmiFYMl21yFU4elQqtBqE8upJc0Knxx25YeUJuoNjQq0WK4VoVb9/t37GtffNC2EUCXEFeCz85qWBGbVSsnzFTKUivigcnoxMu1jWIiExaykWb4Ri80Cq/20dyL+9BFgyQ8KzglY4mIIVKs1SCMS1DCJGESmJVor8wiwvtK4jmmdDzwR5SXOhSsMi9Dp1lID7aySke9kcmf3RXuXMAIWUFEcrCxIycaayEQ9JXEkxAKslnKwHCuew1rEn8lU+aTFtZX3OMP371u1mFbUd8+o4WNUFGvZoAKECxKVYCVokVtkVqjeBaywVyFYqu08urCf8aKiaQEWm3VQZlhyCgUrmQTcErxWaoonrHYftOiHcQlWDEvTkvkcAhYtKSzTVykvOukx/eJtnsGwWZOvhFgOVvIZN5YVa4+1l1HT4XYHrB+mpFkMC7h2O/yZoGlZsVqu4gOwAiq267wkHjrm28O9yzCmEJQ0Lpui1ynF41PDF/YFfi+dWSGvBKwsvBIH0oLXIf6hFOuHn3gO2SxmtZ33OiS/zmot4Sc0h/UVIvUVti2u2x3/SuY8jl92YdMcYgqdVpSLYghlkuPwSpOaeaHzxMF6yV4JWBMWFWgtIBMAEJ3CEZtlYB0EDOvk+R2zFR1VC42hTtWzGVy5v2LdMtVFADplmM+rdpGEOL0DE7G6SKhixIJaQAWxkNkXwiwhFsPy3dNYSJxYnkq0LKvrYEWwfsiHxzBkFsTqmDKpRXGt9ShxfC1cYVoa2O2y1zEJUkuErodFCwqoiNXFC8kYWMmx4yF8MQuxHrBZkw4V8hSwXGUxKTo1+F7n5DQr96HKP01FmQW1mglPRna8vCI2Mpbi/RWiteTcglhxaskMewPuKngRa0h5naMqPIWLhEqMoYFlWbFZBfGgkJLzYhIchKYQtFrRZu2sgmKnqDq8Ch3kV6xA+ZWVJbCibTIc+4/5Ecd7l9vnvCFQsqTwC1MYO4eLMygsDCHRcmYJr5xZ2RNiLaS9mKjWX4VYaHgLaxlrlc2KmUJb8e6SyA1fXwIsh+tu4MUkQc+n8jNfyKB3gRD9kTZQIalYWKkviBVFo6IVMuumZSVhTcqn/Bb2Ml5cpqVYDw8TbgzdFO50eRVNpuFgIccPpqsECwusEHRZTAY1KkT/Jlgjxiq7L46kvbikR2kEgWoWrB68lGYxqqcSVugmxb7y4pJzx3eIde8gI2GBFWg1E7FONLeEWuthWFYu8Br0YjN82wW4Bj2QshOIoN9jGx6w7BCKMRReObMmuLAMrAkvNgUhFsEKQmPozFquxTLH4UHQqnqIqi4RrWO3qOqr3WDddbQMLEMLOR0siAW1iNXLB24Mw6woDIsPDUB1WlgGlYTFrEArHpZnYDGtY1i1JQrkQohWF1h5goXlYF3kCUT+dAqzZhftFIoxJEw32as2WPwZ+V1glZ1ZYCVhOVar3WEJWpZKTbNCYFc3s36Xt48f8YNNsMDJmTXSBdYosZoFK5MQrFfslTBLn90XdLsjEyreLMdKwlp2jwx3aHcdwzeGFZaDVXWgdLqNIShZXNhU8MxJmxVf8IoK/oVmhSEMm1UK9RXlMRe8G0J9k6J7wYca66efdjMMS5i127XghVt17iwOzOriZ/2uDB0dQqSwsl5csjOzmpU161V4DOesV8KsXKjcAavb0UGKdY+PDuLgsLOzG8QeJxtkVtgtvhoyKP2r29GBDvkS1tBFSavkxaU0A1b45j2gEmPIXgmzssIruqFTiFWi5S6FMOshH0pDrLC6HEqZleXFh1I6oL51xOhkH5PEI/tw2yKjk8aAA4X9pyHf6xx/3LCyYl2TZjlUjxlWAajCt+sn4x/uhM8NpNa0J8xCNKud2LqZAiusd1tb72k1LJT80vrbdaJl1wodVmNSvktnfLv0Y8m6V7SsmFYq7gA/OqtpGVQPXl0TZvEQPnZmJfc2Bav/in0gPSXEokx50qxleIUV+0C6+UazYrUamePx1Kcuw2qFaNUSMRfD+n2OITbspUYMKCydARXzOJpAgRRCqAQsQjVnUYXMUvsWFd+BjpnDzCFYIUAFWnkJa0d7pXc+dgo1La0Wdk0dUySz3i9Zud4SsJi/knl0DMrmUdlLXmCvdC6NpGIe7MxyYV2jJcZQiLWpYSGTQqx4tXJhsYBrNyPGcEfTwhTu7HSWIlEDK2yr1/vjmVXVdaJFmxaF+ivmehgSyz2SHGBUBtaljq3lVywrFutm2Kw5i0qHYRVAyqGi5Do21mG4sRD3tLK9rwNU8GptZ61j39QhlmWl1Vpnf+rr78ms9wSrq1rlR/fFM4XmkWQWpJxYRKvUAXeJUDmvKK9CsIxX82SVxsX+JPdOwPr7XqH7pdBVFsNaNWbRIrMou+VO5wZNCj/vDLEm/HSl9R4LdoFXs9xJzxWwwkJADVyTFwQqgjVSjKSVHZ0lVlhXcSEkVDdDsEiseRaLzaJMCFSgdRhE39wBKyHWQSBgaVZYwPW/O8xAJNOEVuwWmbVVDR3tNSosO4lvHwWRrKpEiDFpZvperRoAJoaFjEbQUpaVEQtmEa+fHSw7g1CLsumaqeBeMXP8Ytv9csQ/j8+jLBadsgSsVYpFZWoriPAKhbVhUNnf792oqbwRC2oRLwCTtJgVo2JoBnlqhKXC1iklPZlkCawI1VVa16xYwiwSax6g8K2Fm48dLH8fqOQLIvcKypMJWsyKxXqY98KwVskssAIuEotWs/3FV803v2hI4EVaYTcTYe8MKu0WNq1mXrURX2lLo2x7G6gMLZvLl8aKYVx+dnwGqDCDBhbl5qub0iz2Spjl5XByZ1bmtVhH8m06malDsDopVsKLGkNkzeDargotguo2GAGXy1ZdPD3/fgusLDCN622jGoh/TL2xsvJWr1AGlcdqMSqQuoyMl1JJX3nKT6ZK4zOaFeoKfaVH8KY0SzeW9orE2sTRwaklvAIs4GoVAmXfLjh9eF2yuqcT8mYKMyhQrREsym41n7F/Jl9t/PIGC3tDjyBV/LtmRlYa0cLWeQtixKvh/kq5+ogw0eYVFku3ltQKuOhndGy8UqmMj43OECtjFrG6agrrJjWWNGv+MRbRIlYwi5PjwtJe8fsDjg5b09PTrcMjfi6ZYYnGAix7MTS0gAusNK6N3VqtWq3Vdjd+obzB7iQWUn//DqysXeAFWqRXrUqpNQkUocIWq6rcixiAin7YK+QL2siMZQWxwEqjMpl7FoKlRxCsbpyApSasVwIVIl82I8U6KHsC1o4zi0jpMTT5Rf/SIV7GLF1ZEOvNycNrokas3tEGKZe3UWFU4ipQvMRaYWtURIpZARW8opi6MvX+81zILGOVZSVhlff4QqhnEKzky/xku/MZy8FatZVlY7RawyZQWAKXc4vHh5NvECrSC4Y5VubXCVScFdF7A47WccKoZtyF0A4hUN2cC5tlh9C+ndDBQnLhwpKsrreLpVmh3QUskApfCtecWMyKUTEtPmOJQXxHJ3vDi0OkBC6hlhtCxB8SfUWosIgVaC2GxDKoAAu4BCx7aiCzFk7CUtORXoHWdcnKevVQHFwBC16FzdJL0gIqIZYdQhmlaiAFsd4xMCam98nUMidfqSb7CqQsK4vqgZ7Bq8wKYoVgkVY8hAsLAhbFb4GVE4tZCa9YLFFYwiwGhW2yYbyycglgTYtcJlMjtWiBlVkSF1Y4bW9dVOkhsMKSrBCtlb0SIrbd58isJMPibodYgCWS2deo2KtIVizWQd7jOLMkLjGFWBxm5QpLJmi+4zhgjEvyinz4mB4yoICKYbFXQEVD+ITFmoNYYVj6i45Ba0GbpTyZTAuoorxCvQuvBCuGdXIGBS42i0nR785vzwStLWxE0BK8BCuZzIAcQqASYl27Oj4pxZp77jMs0IJWNxYoETdTky0uLGYVXViHZa8dliis7V1GpXGdNAs/byQrmaDmzMJPm178S8ygfLE7eyUPDWBFqSSzLBZQzc07WDeMV0AFWIWIPz99dPLQ8NeowhJvkhZm8SFrO990YpnlxKLALDIiJokqKHEMLskLW3a7TLoyetmxOnHEelLyvWxILOS5YlgYQ35rzoSFKKIKh21etR3dD6YSngibFZrC7SBTC5tFSzQW/aoBeVzqDcdKAnPIGvVE7Oc6VEbtECKMijKeUsREoHo6z9M2afvKZD/oYP/00V+EV4IVYLXKnoqCFRILYxh4ialtAcrRQmL+l5xAyuXGkd2qlbt+YkhlzE3hrMV1dTyrXakAFtf7/Nykg0VZoEWo/mMi6XVKoeXeG9D+MOdQfKqDgLUcrnf93Hy5tubEkg1fjdOKo/I1icu1PX6d7oNHktkKHjzrGFKVlG9IjqOyLKqnc/PzWYZAZpnC2psoxL7SsjB9ZMQ6eWo4aAlUIsE2swItc58hka9tO1Sc7Zp4+qcLLjeMHLjVkKhi46ezJXrCgVIpFVMsSvpJeAoJVsE9D3NDH933JtPKi48Kcq2DkxfCg8Pp2O8gz+9uu3AfJcrV3Q1x0NpuVrujEv+YejuvRq3Of+TUUb4vv/E6S17xDBIrPmYRR9DazyVP+U8s0FMzBwdH3313cHBAz9TkQCo2iaB8HPlUXX6q1mxsb2xsb+82a3Xxd07LK1+lP9EgoRqNRrNWzQeJD/JNRCyWgSXer1oo4B2Ep08iE5QpQZBQ3m9LIqP/UPfPGov/xyD6O9G9DxFMIVBZWvPzE7/5+8UVrTMZxWIZr9DvPRg/Wyp2b5usE8tWVroHWakSndvHin6XIRyXjcWV1VtJjerHOJVUXH8k3RkLsJDJXhSrQmIho5W06uzVNdFYvTmFEOsLiGVwpfzoJySeaVZXuLIo+6oXxWJWwDVePHlcUsns+PGTfnO9fS2EWI7VDO3R8VI2nfQV4ifT9EjxGgKvuLJ6tN59EovDT4/S3Wh9O3p87MlVg+ralWuysnK9LdYMs8Jzo/Rjck3jEo+g5/piMa1ZLADTqDSrK1RZVzCJltWzHm0siQqxpKxaQKXNAih+WKh6EFZJDqHJVWwNC2ZdAS4j1k0ewqTXi7DEEGJrWrMzV1kssLLtfsWK9azgeT09hmzWLBYanlldgVjoK9tYKKxejCqOOa94CvWywRTaGbSlBVY9mlTF0mJg1qzQxfCKwYUxBCvl9Wz87LisdyGWPZMiprGeF7yeThKz2DaIXPBXoJatrCt8U7Cn7eJbhQYUtqusY1bPMYK9HqVvRTOuWTGHMEuP4XPcl0b6UbgVze1+FbisWPqY9axCqPpeCV4lunc/i4QK/uqz8Ylssh1UP34yVSxVxjmV0mQWzwf283+mTiSAK46jBAAAAABJRU5ErkJggg\u003d\u003d"
  },
  "description": "Tag para envio de eventos para o Pixel da Globo.",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "pixelClientId",
    "displayName": "Pixel Id",
    "simpleValueType": true,
    "valueValidators": [
      {
        "type": "REGEX",
        "args": [
          "^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$"
        ]
      }
    ],
    "help": "Unique identifier (UUID v4) of the pixel provided for each client (e.g., \"6ba7b810-9dad-11d1-80b4-00c04fd430c8\")."
  },
  {
    "type": "SELECT",
    "name": "actionType",
    "displayName": "Action Type",
    "macrosInSelect": false,
    "selectItems": [
      {
        "value": "PageView",
        "displayValue": "PageView"
      },
      {
        "value": "Click",
        "displayValue": "Click"
      },
      {
        "value": "AddPaymentInfo",
        "displayValue": "AddPaymentInfo"
      },
      {
        "value": "AddToCart",
        "displayValue": "AddToCart"
      },
      {
        "value": "AddToWishlist",
        "displayValue": "AddToWishlist"
      },
      {
        "value": "Search",
        "displayValue": "Search"
      },
      {
        "value": "Subscribe",
        "displayValue": "Subscribe"
      },
      {
        "value": "CompletePayment",
        "displayValue": "CompletePayment"
      },
      {
        "value": "SubmitForm",
        "displayValue": "SubmitForm"
      },
      {
        "value": "InitiateCheckout",
        "displayValue": "InitiateCheckout"
      }
    ],
    "simpleValueType": true,
    "clearOnCopy": false
  },
  {
    "type": "TEXT",
    "name": "actionValue",
    "displayName": "Action Value",
    "simpleValueType": true,
    "help": "Field for sending metadata and/or additional information about the action."
  },
  {
    "type": "TEXT",
    "name": "orderId",
    "displayName": "Campaign ID",
    "simpleValueType": true,
    "help": "Unique identifier for the campaign at Globo."
  },
  {
    "type": "GROUP",
    "name": "additionalProperties",
    "displayName": "Additional Properties",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "RADIO",
        "name": "hasContent",
        "displayName": "Content Configuration",
        "radioItems": [
          {
            "value": 1,
            "displayValue": "With Contents"
          },
          {
            "value": 0,
            "displayValue": "No Contents"
          }
        ],
        "simpleValueType": true,
        "defaultValue": 0
      },
      {
        "type": "TEXT",
        "name": "value",
        "displayName": "Value",
        "simpleValueType": true,
        "help": "Total purchase amount as an integer or float, formatted as 99.99 (no special symbols or letters such as $)."
      },
      {
        "type": "TEXT",
        "name": "currency",
        "displayName": "Currency",
        "simpleValueType": true,
        "help": "Specifies the currency of the total purchase amount in ISO 4217 format (e.g., BRL, USD, or EUR).",
        "valueValidators": [
          {
            "type": "REGEX",
            "args": [
              "^[A-Z]{3}$"
            ]
          }
        ],
        "valueHint": "BRL"
      },
      {
        "type": "TEXT",
        "name": "contents",
        "displayName": "Contents",
        "simpleValueType": true,
        "valueHint": "[{\"contentId\": \"1234\", \"contentName\": \"name\", \"price\": 10, \"quantity\": 1}]",
        "enablingConditions": [
          {
            "paramName": "hasContent",
            "paramValue": 1,
            "type": "EQUALS"
          }
        ],
        "help": "A list of valid content objects encoded as \u003ca href\u003d\"https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Objects/JSON\" target\u003d\"_blank\"\u003ea valid JSON string\u003c/a\u003e. (e.g., [{\u0027contentId\u0027: \u00271234\u0027, \u0027contentName\u0027: \u0027name\u0027, \u0027price\u0027: 10, \u0027quantity\u0027: 1}])"
      },
      {
        "type": "TEXT",
        "name": "contentType",
        "displayName": "Content Type",
        "simpleValueType": true,
        "valueHint": "product or product_group",
        "enablingConditions": [
          {
            "paramName": "hasContent",
            "paramValue": 1,
            "type": "EQUALS"
          }
        ],
        "help": "Select \u0027product\u0027 if the IDs in \u0027contents\u0027 parameter refer to individual products. Choose \u0027product_group\u0027 if the IDs refer to groups of products."
      }
    ]
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

const log = require('logToConsole');
const injectScript = require('injectScript');
const callInWindow = require('callInWindow');
const copyFromWindow = require('copyFromWindow');
const queryPermission = require('queryPermission');
const encodeUriComponent = require('encodeUriComponent');
const getUrl = require('getUrl');
const getReferrerUrl = require('getReferrerUrl');
const getTimestampMillis = require('getTimestampMillis');
const generateRandom = require('generateRandom');
const setCookie = require('setCookie');
const getCookieValues = require('getCookieValues');
const getQueryParameters = require('getQueryParameters');
const sha256 = require("sha256");
const JSON = require("JSON");
const makeNumber = require("makeNumber");

log("data=", data);

var pixelData = {};
const clientVersion = "GTM-1.0";
const postScriptUrl= "https://s3.glbimg.com/v1/AUTH_da787d4f4e8d46e3ad76d5fa568fe786/globo-pixel/prod/sendGloboPixelEvent.js";

// Generates UUID V4
function generateUUID() {
    var uuid = "";
    for (var i = 0; i < 36; i++) {
        if (i === 8 || i === 13 || i === 18 || i === 23) {
            uuid += "-";
        } else if (i === 14) {
            uuid += "4";
        } else if (i === 19) {
            uuid += "89ab"[generateRandom(0, 3)];
        } else {
            uuid += "0123456789abcdef"[generateRandom(0, 15)];
        }
    }
    return uuid;
}

// Checks if a string matches a SHA256 hash format using regular expressions
const isValidSHA256 = (str) => {
  const regexSHA256 = "/^[a-fA-F0-9]{64}$/";
  return str && str.match(regexSHA256) != null;
};


// Generates and sets the browserId as a browser cookie if it does not exist and returns the cookie value
const getBrowserId = () => {
  const browserCookieExpires = "Thu, 31 Dec 2099 23:59:59 GMT";
  const browserCookieName = "GBID";
  let browserId = getCookieValues(browserCookieName)[0];
  
  if(!browserId) {
  browserId = browserCookieName + "." + getTimestampMillis() + "." + generateUUID();
  setCookie(browserCookieName, browserId, {path: "/", domain:"auto", 'expires': browserCookieExpires});
  }
  
  log("[INFO] browserId:", browserId);
  return browserId;
};

// Sets the gadv_id parameter as a browser cookie if it exists and returns the cookie value
const getGadvId = () => {
  const gadvIdCookieName = "gadvId";
  const gadvIdParameterName = "gadv_id";
  const secondsIn90Days = 7776000;
  
  let gadvId = getQueryParameters(gadvIdParameterName);
  let gadvIdCookie = getCookieValues(gadvIdCookieName)[0];
  
  if (gadvId){
    setCookie(gadvIdCookieName, gadvId , {path: "/", domain:"auto", 'max-age': secondsIn90Days});
    return gadvId;
  } 
  else if(gadvIdCookie){
    log("[INFO] gadvId Cookie:", gadvIdCookie);
    return gadvIdCookie;
  }
  
  return null;
};

// Sets user information and hashes the value if provided in raw form
//const getUserInformation = () => {
//  let userData = {};
//  
//  if (data.isHashed){
//    log("[INFO] User data is hashed.");
//    if (data.hashedEmail && isValidSHA256(data.hashedEmail)) userData.email = data.hashedEmail;
//    if (data.hashedCpf && isValidSHA256(data.hashedCpf)) userData.cpf = data.hashedCpf;
//    if (data.hashedPhone && isValidSHA256(data.hashedPhone)) userData.phone = data.hashedPhone;
//  } else {
//    if (data.email) sha256(data.email, (hashedValue) => {
//    userData.email = hashedValue;
//    data.gtmOnSuccess();
//    }, data.gtmOnFailure(),
//     {outputEncoding: 'hex'});
//    
//    if (data.cpf) sha256(data.cpf, (hashedValue) => {
//    userData.cpf = hashedValue;
//    data.gtmOnSuccess();
//    }, data.gtmOnFailure(),
//   {outputEncoding: 'hex'});
//    
//    if (data.phone) sha256(data.phone, (hashedValue) => {
//    userData.phone = hashedValue;
//    data.gtmOnSuccess();
//    }, data.gtmOnFailure(),
//    {outputEncoding: 'hex'});
//  }
//  if (userData.length > 0) return null;
//  return userData;
//};

// Validates that content is not empty and can be parsed as JSON
const isContentValid = () => {
  if (data.contents) {
    const jsonParsedContents = JSON.parse(data.contents);
      if (jsonParsedContents !== undefined) {
        return true;
      }
  }
  log("[WARN] Contents are not valid. Must be a valid JSON as string. Received:", data.contents);
  return false;
};

// Validates that content type is not empty and it has a valid value
const isContentTypeValid = () => {
  const validsContentTypes = ["product", "product_group"];

  if (!data.contentType) {
    log("[WARN] Content Type is empty or undefined.");
    return false;
  }

  const isValidContentType = validsContentTypes.some(validContent => {
    return data.contentType === validContent;
  });

  if (isValidContentType) {
    return true;
  } else {
    log("[WARN] Content Type invalid. Valid values: product and product_group. Received:", data.contentType);
    return false;
  }
};

// Calls the sendGloboPixelEvent method to send event to backend
function sendEvent() {
  log("[INFO] Sending Pixel Data.");
  callInWindow('sendGloboPixelEvent', pixelData);
}

const main = () => {
  // Populates event data
  pixelData.clientVersion = clientVersion;
  pixelData.browserId = getBrowserId();
  pixelData.gadvId = getGadvId();
  pixelData.pixelClientId = data.pixelClientId;
  pixelData.actionType = data.actionType;
  pixelData.actionUUID = generateUUID();
  pixelData.actionTs = getTimestampMillis();
  pixelData.referer = getReferrerUrl();
  pixelData.url = getUrl();
  
  // Optional fields
  //var userData = getUserInformation();
  //if (userData) pixelData.userInformation = userData;
  
  if (data.orderId) pixelData.orderId = data.orderId;
  if (data.actionValue) pixelData.actionValue = data.actionValue;
  if (data.currency) pixelData.currency = data.currency;

  var valueFieldNumber = makeNumber(data.value);
  if (valueFieldNumber) {
    pixelData.value = valueFieldNumber;
  } else if (data.value && ! valueFieldNumber){
    log("[WARN] Value invalid. Must be an integer, float, or convertible string. Received:", data.value);
  }
  
  // Checks and sets content fields
  if (data.hasContent && isContentValid()) pixelData.contents = JSON.parse(data.contents);
  if (data.hasContent && isContentTypeValid()) pixelData.contentType = data.contentType;


  if (queryPermission('inject_script', postScriptUrl)) {
    injectScript(postScriptUrl, sendEvent, data.gtmOnFailure, postScriptUrl);
  } else {
    log("[ERROR] Script load failed due to permissions mismatch.");
    data.gtmOnFailure();
  }
};

main();
data.gtmOnSuccess();


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "sendGloboPixelEvent"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://s3.glbimg.com/"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_cookies",
        "versionId": "1"
      },
      "param": [
        {
          "key": "cookieAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "cookieNames",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "GBID"
              },
              {
                "type": 1,
                "string": "gadvId"
              },
              {
                "type": 1,
                "string": "GLOBO_ID"
              },
              {
                "type": 1,
                "string": "gpixel_uid"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_referrer",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urlParts",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "queriesAllowed",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "set_cookies",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedCookies",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "name"
                  },
                  {
                    "type": 1,
                    "string": "domain"
                  },
                  {
                    "type": 1,
                    "string": "path"
                  },
                  {
                    "type": 1,
                    "string": "secure"
                  },
                  {
                    "type": 1,
                    "string": "session"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "GBID"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "name"
                  },
                  {
                    "type": 1,
                    "string": "domain"
                  },
                  {
                    "type": 1,
                    "string": "path"
                  },
                  {
                    "type": 1,
                    "string": "secure"
                  },
                  {
                    "type": 1,
                    "string": "session"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "gadvId"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_url",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urlParts",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "queriesAllowed",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios:
- name: Simple Configuration Test
  code: |-
    const mockData = {
        "actionType": "PageView",
        "hasContent": 0,
        "isHashed": 0,
        "pixelClientId": "0736678c-0b56-47f8-b84a-091ac092b3a6",
        "currency": "BRL",
        "email": "test@gmail.com",
        "cpf": "12345678912",
        "value": "13",
        "gtmTagId": 17,
        "gtmEventId": 1
    };
    runCode(mockData);

    // Called to get GBID and gadvId cookies
    assertApi("getCookieValues").wasCalledWith("GBID");
    assertApi("getCookieValues").wasCalledWith("gadvId");

    // Called to set GBID
    assertApi("setCookie").wasCalled(1);

    // Called to hash email and cpf
    //assertApi("sha256").wasCalled(2);

    // Called to generate GLBID and actionTs
    assertApi("getTimestampMillis").wasCalled(2);

    // Called to generate GLBID and actionUUID
    assertApi("generateRandom").wasCalled(62);

    // Called to convert "value" field in number
    assertApi('makeNumber').wasCalled(1);

    assertApi("injectScript").wasCalled(1);
    assertApi("gtmOnSuccess").wasCalled();
- name: Simple Configuration Test With Hashed User Information
  code: |-
    const mockData = {
        "actionType": "PageView",
        "hasContent": 0,
        "isHashed": 1,
        "pixelClientId": "0736678c-0b56-47f8-b84a-091ac092b3a6",
        "currency": "BRL",
        "hashedEmail": "6fe656ad6145d733da3cbb0fd0b71dd00600193e20a13c6e07dfc9c7cf528acf",
        "value": "13",
        "gtmTagId": 17,
        "gtmEventId": 1
    };
    runCode(mockData);

    // Called to get GBID and gadvId cookies
    assertApi("getCookieValues").wasCalledWith("GBID");
    assertApi("getCookieValues").wasCalledWith("gadvId");

    // Called to set GBID
    assertApi("setCookie").wasCalled(1);

    assertApi("sha256").wasNotCalled();
    assertApi("injectScript").wasCalled(1);
    assertApi("gtmOnSuccess").wasCalled();
- name: Simple Configuration Test With gadv_id URL Parameter
  code: |-
    const mockData = {
        "actionType": "PageView",
        "hasContent": 0,
        "isHashed": 0,
        "pixelClientId": "0736678c-0b56-47f8-b84a-091ac092b3a6",
        "currency": "BRL",
        "email": "test@gmail.com",
        "cpf": "12345678912",
        "value": "13",
        "gtmTagId": 17,
        "gtmEventId": 1
    };

    mock('getQueryParameters', function(name) {
      return "gadv_id_test";
    });

    runCode(mockData);

    // Called to get gadv_id url parameter
    assertApi("getQueryParameters").wasCalledWith("gadv_id");

    // Called to get GBID and gadvId cookies
    assertApi("getCookieValues").wasCalledWith("GBID");
    assertApi("getCookieValues").wasCalledWith("gadvId");

    // Called to set GLBID and gadv_id
    assertApi("setCookie").wasCalled(2);

    // Called to hash email and cpf
    //assertApi("sha256").wasCalled(2);

    assertApi("injectScript").wasCalled(1);
    assertApi("gtmOnSuccess").wasCalled();
- name: Simples Configuration Test With GBID cookie
  code: |-
    const mockData = {
        "actionType": "PageView",
        "hasContent": 0,
        "isHashed": 0,
        "pixelClientId": "0736678c-0b56-47f8-b84a-091ac092b3a6",
        "currency": "BRL",
        "email": "test@gmail.com",
        "cpf": "12345678912",
        "value": "13",
        "gtmTagId": 17,
        "gtmEventId": 1
    };

    mock('getCookieValues', function(name) {
      if (name == "GBID") return ["GLBID.12345"];
      return [];
    });

    runCode(mockData);

    // Called to get GLBID and gadvId cookies
    assertApi("getCookieValues").wasCalled(2);

    // Not called because GLBID already exists
    assertApi("setCookie").wasNotCalled();
    assertThat(infos).contains("[INFO] browserId: GLBID.12345");

    // Called to hash email and cpf
    //assertApi("sha256").wasCalled(2);

    assertApi("injectScript").wasCalled(1);
    assertApi("gtmOnSuccess").wasCalled();
- name: Simple Configuration Test With Invalid Value
  code: |-
    const mockData = {
        "actionType": "PageView",
        "hasContent": 0,
        "isHashed": 0,
        "pixelClientId": "0736678c-0b56-47f8-b84a-091ac092b3a6",
        "currency": "BRL",
        "email": "test@gmail.com",
        "cpf": "12345678912",
        "value": "abc",
        "gtmTagId": 17,
        "gtmEventId": 1
    };
    runCode(mockData);

    // "value" field invalid
    assertApi('makeNumber').wasCalledWith("abc");
    assertThat(warns).contains("[WARN] Value invalid. Must be an integer, float, or convertible string. Received: abc");

    assertApi('gtmOnSuccess').wasCalled();
- name: Configuration With Contents Test
  code: |-
    const mockData = {
        "actionType": "PageView",
        "hasContent": 1,
        "isHashed": 0,
        "pixelClientId": "0736678c-0b56-47f8-b84a-091ac092b3a6",
        "currency": "BRL",
        "contentType": "product",
        "contents": '[{"contentId": "1234", "contentName": "name", "price": 10, "quantity": 1}]',
        "value": "13",
        "gtmTagId": 17,
        "gtmEventId": 1
    };
    runCode(mockData);

    assertApi("injectScript").wasCalled();
    assertApi("gtmOnSuccess").wasCalled();
- name: Configuration With Contents Test And Invalid Contents
  code: |-
    const mockData = {
        "actionType": "PageView",
        "hasContent": 1,
        "isHashed": 0,
        "pixelClientId": "0736678c-0b56-47f8-b84a-091ac092b3a6",
        "currency": "BRL",
        "contentType": "product123",
        "contents": '["contentId": "1234", "contentName": "name", "price": 10, "quantity": 1]',
        "value": "13",
        "gtmTagId": 17,
        "gtmEventId": 1
    };
    runCode(mockData);

    assertThat(warns[0]).contains('[WARN] Contents are not valid. Must be a valid JSON as string. Received: ["contentId": "1234", "contentName": "name", "price": 10, "quantity": 1]');
    assertThat(warns[1]).contains("[WARN] Content Type invalid. Valid values: product and product_group. Received: product123");
    assertApi("injectScript").wasCalled();
    assertApi("gtmOnSuccess").wasCalled();
setup: "const log = require(\"logToConsole\");\nconst JSON = require(\"JSON\");\n\n\
  const warns = []; \nconst infos = [];\n\nmock('logToConsole', function() {\n  const\
  \ stringArray = arguments.map(item => {\n    if (typeof item === 'object' && item\
  \ !== null) {\n      return JSON.stringify(item);\n    } else {\n      return item.toString();\n\
  \    }\n    });\n  \n  const logMessage = stringArray.join(\" \" );\n  \n  if (logMessage.length\
  \ > 0 && logMessage.substring(0, 6) == '[WARN]') {\n    warns.push(logMessage);\n\
  \  } else if (logMessage.length > 0 && logMessage.substring(0, 6) == '[INFO]') {\n\
  \    infos.push(logMessage);\n  }\n  log(logMessage); \n});"


___NOTES___

Created on 02/02/2024, 10:45:57


